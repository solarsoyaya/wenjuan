import{d as V,R as B,S as z,bj as R,y as j,J as y,c as m,b as o,a,w as n,F as g,X as q,u as b,C as E,D as J,Q as w,cl as L,r as f,o as d,k as r,a0 as k,j as O,B as Q,_ as $}from"./index-CorONKRg.js";import{u as I}from"./useEditor-CEeZLYcK.js";import{a as M}from"./material-BFAZqrzv.js";import{u as U}from"./hooks-pbYTGw1V.js";const H={ref:"preview-container",class:"preview-container pb-40"},X={class:"center mc"},A={class:"button-group flex space-between align-items-center"},G={class:"flex space-between no-print"},K={class:"mr-15"},W={class:"content-group no-border"},Y=["href"],Z={class:"dialog-footer"},ee=V({__name:"Preview",setup(te){const v=E(),h=J(),s=I(),p=Number(h.params.id);p&&B(p).then(t=>{t&&(z(t.coms),s.setStore(t))});const C=function(){window.scrollTo({top:0,behavior:"smooth"})};R(()=>{C()});const x=j(()=>U(s.coms).value),N=()=>{history.state.from==="home"?v.back():v.push(`/editor/${p}/survey-type`)};function S(){if(!s.coms.every(e=>M(e.name))){w({message:"存在不支持PDF导出的组件，请先移除这些组件",type:"warning"});return}window.print()}const i=y(!1),l=y("");function D(){const t=L();fetch("/api/saveQuiz",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,quizData:{coms:JSON.stringify(s.coms),surveyCount:s.surveyCount}})}),l.value=`${window.location.origin}/quiz/${t}`,i.value=!0}function F(){i.value=!1,navigator.clipboard.writeText(l.value),w({message:"链接已复制",type:"success"})}return(t,e)=>{const u=f("el-button"),P=f("el-text"),T=f("el-dialog");return d(),m(g,null,[o("div",H,[o("div",X,[o("div",A,[o("div",G,[a(u,{type:"danger",onClick:N},{default:n(()=>e[1]||(e[1]=[r("返回")])),_:1}),a(u,{type:"success",onClick:D},{default:n(()=>e[2]||(e[2]=[r("生成在线问卷")])),_:1}),a(u,{type:"warning",onClick:S},{default:n(()=>e[3]||(e[3]=[r("生成本地PDF")])),_:1})]),o("div",K,[a(P,{class:"mx-1"},{default:n(()=>[r("题目数量："+k(b(s).surveyCount),1)]),_:1})])]),o("div",W,[(d(!0),m(g,null,q(b(s).coms,(c,_)=>(d(),m("div",{class:"content mb-10",key:_},[(d(),O(Q(c.type),{status:c.status,serialNum:x.value[_]},null,8,["status","serialNum"]))]))),128))])])],512),a(T,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=c=>i.value=c),title:"信息",width:"500"},{footer:n(()=>[o("div",Z,[a(u,{type:"primary",onClick:F},{default:n(()=>e[4]||(e[4]=[r("复制链接")])),_:1})])]),default:n(()=>[e[5]||(e[5]=r(" 分享链接: ")),o("a",{href:l.value,target:"_blank"},k(l.value),9,Y)]),_:1},8,["modelValue"])],64)}}}),re=$(ee,[["__scopeId","data-v-e0051039"]]);export{re as default};
